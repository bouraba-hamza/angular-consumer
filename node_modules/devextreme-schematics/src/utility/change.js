"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const change_1 = require("@schematics/angular/utility/change");
function getSeparator(text) {
    const isEmpty = text.search(/}\s*,?\s*]/g) !== -1;
    return isEmpty ? ', ' : '';
}
/* tslint:disable:max-line-length */
function prepareChangesForAdditionInArray(recorder, filePath, changes, content, endIndex) {
    /* tslint:enable:max-line-length */
    const position = content.lastIndexOf(']', endIndex);
    if (position > -1) {
        const insertData = new change_1.InsertChange(filePath, position, getSeparator(content) + changes);
        recorder.insertLeft(insertData.pos, insertData.toAdd);
    }
    return recorder;
}
function applyChanges(host, changes, filePath, content, endIndex) {
    let recorder = host.beginUpdate(filePath);
    if (Array.isArray(changes)) {
        for (const change of changes) {
            recorder.insertLeft(change.pos, change.toAdd);
        }
    }
    else if (content && endIndex) {
        recorder = prepareChangesForAdditionInArray(recorder, filePath, changes, content, endIndex);
    }
    host.commitUpdate(recorder);
    return host;
}
exports.applyChanges = applyChanges;
//# sourceMappingURL=change.js.map